<!DOCTYPE html>
<html>
<head>
    <title><%= text.page.mobility.title %></title>
    <% include ../partials/head %>
</head>
<body>
    <header>
        <% include ../partials/header %>
    </header> 
    <main>
        <section>
            <div class="container">
                <div class="row">
                    <div class="col-sm-6">
                        <h1><%= text.page.mobility.h1 %></h1>
                        <p><%- text.page.mobility.description %></p>
                        <div style="text-align: center;">
                            <button 
                             class="btn btn-primary"
                             @click="open()"
                             style="margin: 15px;"
                            >
                            <%= text.page.mobility.button %>
                            </button>
                        </div>
                        <p><%= text.page.mobility.list_desc %></p><br>
                        <ul>
                        <% Object.values(text.page.mobility.list).forEach(function(point) { %>
                            <li>
                                <%= point %>
                            </li>
                        <% }) %>
                        </ul>
                    </div>
                    <div class="col-sm-6 text-img">
                        <img src="/assets/img/mobility_car.jpg">
                    </div>
                </div>
                <div class="row">
                    <div class="col-lg">
                        <div class="card mx-auto" style="max-width: 350px;">
                            <div class="card-header"><b><%= text.page.mobility.sign %></b></div>
                            <div class="card-body">
                                <div class="input-group mb-3">
                                    <div class="input-group-prepend">
                                        <span class="input-group-text"><i class="fas fa-user"></i></span>
                                    </div>
                                    <input
                                        class="form-control"
                                        type="text"
                                        placeholder="naam@student.uhasselt.be"
                                        v-model="email"
                                        @keydown.enter="submit()"
                                    >
                                </div>
                                <div class="input-group">
                                    <button
                                        class="btn btn-primary"
                                        @click="submit()"
                                        style="margin-left: auto;"
                                    >
                                        <%= text.page.mobility.sign_button %>
                                    </button>
                                </div>
                                <!-- <div>
                                    <p>134 anderen tekenden al dit plan!</p>
                                </div> -->
                            </div>
                        </div>
                    </div>
                </div><br>
                <div class="row">
                    <div class="col">
                        <p><%- text.page.mobility.questions %></p>
                    </div>
                </div>
            </div>
        </section>
    </main>
    <footer>
        <% include ../partials/footer %>
    </footer>
    <script>
const app = new Vue({
    el: 'main',
    data: {
        email: '',
        project: 'mobility'
    },
    methods: {
        submit: async function() {
            if (!this.email) return;

            const result = await fetch(`https://api.${location.host}/sign`, {
                credentials: 'include',
                method: 'POST',
                headers: {
		            'content-type': 'application/json',
                },
                headers: {
                    'Content-Type': 'Application/json'
                },
                body: JSON.stringify({
                    email: this.email,
                    project: this.project,
                }),
            }).then(res => res.json());

            this.email = '';
            this.studentnumber = '';
        },
        open: function() {
            window.open('/assets/files/20191102-Mobiliteit-op-en-rond-de-campussen.pdf', '_blank');
        }
    }
});
    </script>
</body>
</html>
