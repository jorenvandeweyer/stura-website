<!DOCTYPE html>
<html>
<head>
    <title>Recovery | StuRa UHasselt</title>
    <% include ../../partials/head %>
</head>
<body>
    <header>
        <% include ../../partials/header %>
    </header>
    <main>
        <div class="content">
            <div class="form">
                <p>Kies een nieuw wachtwoord</p>
                <input 
                    id="password" 
                    type="password" 
                    placeholder="wachtwoord"
                    v-model="password"
                    @keydown.enter="setPassword()"
                    />
                <input 
                    id="password_confirm" 
                    type="password" 
                    placeholder="wachtwoord bevestigen"
                    v-model="password_confirm"
                    @keydown.enter="setPassword()"
                    />
                <button
                    class="button"
                    @click="setPassword()"
                >
                    Instellen
                </button>

            </div>
        </div>
    </main>
    <script>
    const vm = new Vue({
        el: ".content",
        data: {
            token: query.get('token'),
            password: '',
            password_confirm: '',            
        },
        methods: {
            setPassword: async function() {
                const result = await call("/account/forgot", {
                    method: 'PUT',
                    body: {
                        token: this.token,
                        password: this.password,
                        password_confirm: this.password_confirm,
                    },
                });

                if (result && result.success) {
                    goTo('/admin/login');
                } else {
                    console.log('false', result);
                    //laat een error popup zien???
                }
            },
        }
    });
    </script>
</body>
</html> 
